<!doctype html>
<html lang="en">
<head>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Impact Dashboard — FFY 2024</title>
  <link rel="stylesheet" href="../Assets/shared.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pptxgen-js/3.12.0/pptxgen.bundle.min.js"></script>
  <style>
    table { width:100%; border-collapse:collapse; font-size:13px; }
    th, td { padding:10px 12px; border-bottom:1px solid var(--border); text-align:left; }
    th { color:var(--muted); font-weight:800; }
    .tag { display:inline-flex; padding:6px 10px; border-radius:999px; background:rgba(56,189,248,0.12); font-weight:700; }
  </style>
</head>
<body>
  <header class="topbar">
    <div class="wrap space-between">
      <div class="brand">
        <div class="logo">DB</div>
        <div style="margin-left:8px;">
          <div style="font-weight:800">Impact Dashboard</div>
          <div class="subtle" style="font-size:12px;">FFY 2024 Overview</div>
        </div>
      </div>
      <nav class="nav">
        <a class="navLink linkBtn" href="../index.html">Home</a>
        <a class="navLink linkBtn" href="#annual-reports">Annual Reports</a>
        <a class="navLink linkBtn" href="../tools/chain-snapshot.html">Chain Snapshot</a>
      </nav>
    </div>
  </header>

  <main class="wrap">
    <div class="panel" style="margin-bottom:18px;">
      <div class="pill">Test Environment</div>
      <h1 style="margin-top:8px;">Impact Dashboard</h1>
      <p class="subtle">A robust snapshot of Fiscal Year 2024 outcomes, outreach, and resolution performance.</p>
      <div class="btnRow" role="group">
        <button class="btn" onclick="downloadDashboardPPTX()">Download Dashboard (PPTX)</button>
        <a class="btn secondary" href="#annual-reports">View LTCOP Annual Reports</a>
      </div>
    </div>

    <div class="grid">
      <div class="card">
        <h3 style="margin:0 0 4px;font-size:14px;">Total Cases</h3>
        <div style="font-size:32px;font-weight:900;margin:8px 0;">2,628</div>
        <div class="subtle"><span style="color:#22c55e;font-weight:800;">↑ +12.6%</span> vs FFY 2023</div>
      </div>
      <div class="card">
        <h3 style="margin:0 0 4px;font-size:14px;">Resolution Rate</h3>
        <div style="font-size:32px;font-weight:900;margin:8px 0;color:#38bdf8;">83%</div>
        <div class="subtle">3,647 of 4,415 cases</div>
      </div>
      <div class="card">
        <h3 style="margin:0 0 4px;font-size:14px;">Resident Contacts</h3>
        <div style="font-size:32px;font-weight:900;margin:8px 0;">7,980</div>
        <div class="subtle">Direct engagements</div>
      </div>
      <div class="card">
        <h3 style="margin:0 0 4px;font-size:14px;">Facility Visits</h3>
        <div style="font-size:32px;font-weight:900;margin:8px 0;">410</div>
        <div class="subtle">In-person monitoring</div>
      </div>
      <div class="card">
        <h3 style="margin:0 0 4px;font-size:14px;">Volunteer Hours</h3>
        <div style="font-size:32px;font-weight:900;margin:8px 0;">2,860</div>
        <div class="subtle">18 active volunteers</div>
      </div>
      <div class="card">
        <h3 style="margin:0 0 4px;font-size:14px;">Education Events</h3>
        <div style="font-size:32px;font-weight:900;margin:8px 0;">124</div>
        <div class="subtle">Community sessions hosted</div>
      </div>
    </div>

    <div class="panel" style="margin-top:18px;">
      <h2>Case Volume Comparison</h2>
      <p class="subtle">Total cases reported: FFY 2023 vs FFY 2024</p>
      <canvas id="caseChart" style="max-height:280px;margin-top:12px;"></canvas>
    </div>

    <div class="grid" style="margin-top:18px;">
      <div class="panel">
        <h2>Case Themes</h2>
        <p class="subtle">Top reported issue categories in FFY 2024.</p>
        <canvas id="themeChart" style="max-height:240px;margin-top:12px;"></canvas>
      </div>
      <div class="panel">
        <h2>Resolution Timeline</h2>
        <p class="subtle">Average days to resolution by quarter.</p>
        <canvas id="resolutionChart" style="max-height:240px;margin-top:12px;"></canvas>
      </div>
    </div>

    <div class="panel" style="margin-top:18px;">
      <h2>Regional Snapshot</h2>
      <p class="subtle">Highlights from outreach and case volume by region.</p>
      <table>
        <thead>
          <tr>
            <th>Region</th>
            <th>Cases</th>
            <th>Visits</th>
            <th>Top Issue</th>
            <th>Resolution Rate</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>North</td>
            <td>684</td>
            <td>112</td>
            <td>Care Planning</td>
            <td>84%</td>
          </tr>
          <tr>
            <td>Central</td>
            <td>723</td>
            <td>130</td>
            <td>Staffing</td>
            <td>82%</td>
          </tr>
          <tr>
            <td>South</td>
            <td>604</td>
            <td>96</td>
            <td>Resident Rights</td>
            <td>86%</td>
          </tr>
          <tr>
            <td>Coastal</td>
            <td>617</td>
            <td>72</td>
            <td>Quality of Life</td>
            <td>80%</td>
          </tr>
        </tbody>
      </table>
    </div>

    <div class="panel" style="margin-top:18px;">
      <h2>Program Highlights</h2>
      <div class="grid">
        <div class="card">
          <div class="tag">Resident Voice</div>
          <h3>Listening Tours</h3>
          <p class="subtle">Conducted 45 listening sessions and captured 350+ resident comments for quality improvements.</p>
        </div>
        <div class="card">
          <div class="tag">Rapid Response</div>
          <h3>Safety Escalations</h3>
          <p class="subtle">Resolved 92% of high-priority cases within 72 hours through rapid response protocols.</p>
        </div>
        <div class="card">
          <div class="tag">Education</div>
          <h3>Family Support</h3>
          <p class="subtle">Hosted 28 caregiver workshops focused on rights, discharge planning, and Medicare advocacy.</p>
        </div>
      </div>
    </div>

    <div id="annual-reports" class="panel" style="margin-top:18px;">
      <h2>LTCOP Annual Reports Library</h2>
      <p class="subtle">Download the full statewide Long-Term Care Ombudsman Program annual reports.</p>
      <div class="grid" style="grid-template-columns:repeat(auto-fit,minmax(200px,1fr));">
        <div class="card">
          <h3>FFY 2024</h3>
          <p class="subtle">Full annual report (PDF).</p>
          <a class="navLink linkBtn" target="_blank" rel="noopener" href="https://ltcop.org/annual-reports/#ffy-2024">Open Report</a>
        </div>
        <div class="card">
          <h3>FFY 2023</h3>
          <p class="subtle">Full annual report (PDF).</p>
          <a class="navLink linkBtn" target="_blank" rel="noopener" href="https://ltcop.org/annual-reports/#ffy-2023">Open Report</a>
        </div>
        <div class="card">
          <h3>FFY 2022</h3>
          <p class="subtle">Full annual report (PDF).</p>
          <a class="navLink linkBtn" target="_blank" rel="noopener" href="https://ltcop.org/annual-reports/#ffy-2022">Open Report</a>
        </div>
        <div class="card">
          <h3>FFY 2021</h3>
          <p class="subtle">Full annual report (PDF).</p>
          <a class="navLink linkBtn" target="_blank" rel="noopener" href="https://ltcop.org/annual-reports/#ffy-2021">Open Report</a>
        </div>
        <div class="card">
          <h3>FFY 2020</h3>
          <p class="subtle">Full annual report (PDF).</p>
          <a class="navLink linkBtn" target="_blank" rel="noopener" href="https://ltcop.org/annual-reports/#ffy-2020">Open Report</a>
        </div>
        <div class="card">
          <h3>FFY 2019</h3>
          <p class="subtle">Full annual report (PDF).</p>
          <a class="navLink linkBtn" target="_blank" rel="noopener" href="https://ltcop.org/annual-reports/#ffy-2019">Open Report</a>
        </div>
      </div>
    </div>
  </main>

  <footer class="wrap subtle" style="margin-top:18px;">Test environment — data and features may change.</footer>

  <script>
    const caseCtx = document.getElementById('caseChart').getContext('2d');
    new Chart(caseCtx, {
      type: 'bar',
      data: {
        labels: ['FFY 2023', 'FFY 2024'],
        datasets: [{
          label: 'Total Cases',
          data: [2333, 2628],
          backgroundColor: ['rgba(56,189,248,0.4)', 'rgba(56,189,248,0.9)'],
          borderColor: ['rgba(56,189,248,0.8)', 'rgba(56,189,248,1)'],
          borderWidth: 1,
          borderRadius: 8
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: true,
        plugins: {
          legend: { display: false },
          tooltip: { backgroundColor: 'rgba(0,0,0,0.8)', titleColor: '#e6f0fb', bodyColor: '#e6f0fb', padding: 10, borderRadius: 8, displayColors: false }
        },
        scales: {
          y: { beginAtZero: true, ticks: { color: 'rgba(230,240,252,0.55)', font: { weight: 700 } }, grid: { color: 'rgba(255,255,255,0.04)' } },
          x: { ticks: { color: 'rgba(230,240,252,0.55)', font: { weight: 700 } }, grid: { display: false } }
        }
      }
    });

    const themeCtx = document.getElementById('themeChart').getContext('2d');
    new Chart(themeCtx, {
      type: 'doughnut',
      data: {
        labels: ['Care Planning', 'Staffing', 'Resident Rights', 'Quality of Life', 'Billing'],
        datasets: [{
          data: [24, 20, 18, 22, 16],
          backgroundColor: ['#38bdf8', '#a78bfa', '#22c55e', '#fbbf24', '#f97316'],
          borderWidth: 0
        }]
      },
      options: {
        plugins: {
          legend: { position: 'bottom', labels: { color: 'rgba(230,240,252,0.7)', font: { weight: 600 } } }
        }
      }
    });

    const resolutionCtx = document.getElementById('resolutionChart').getContext('2d');
    new Chart(resolutionCtx, {
      type: 'line',
      data: {
        labels: ['Q1', 'Q2', 'Q3', 'Q4'],
        datasets: [{
          label: 'Avg Days to Resolve',
          data: [18, 16, 14, 13],
          borderColor: '#38bdf8',
          backgroundColor: 'rgba(56,189,248,0.15)',
          tension: 0.3,
          fill: true,
          pointRadius: 4,
          pointBackgroundColor: '#38bdf8'
        }]
      },
      options: {
        plugins: {
          legend: { display: false },
          tooltip: { backgroundColor: 'rgba(0,0,0,0.8)', titleColor: '#e6f0fb', bodyColor: '#e6f0fb', padding: 10, borderRadius: 8, displayColors: false }
        },
        scales: {
          y: { ticks: { color: 'rgba(230,240,252,0.55)', font: { weight: 700 } }, grid: { color: 'rgba(255,255,255,0.04)' } },
          x: { ticks: { color: 'rgba(230,240,252,0.55)', font: { weight: 700 } }, grid: { display: false } }
        }
      }
    });

    function downloadDashboardPPTX() {
      try {
        const prsn = new PptxGenJS();
        prsn.defineLayout({ name: 'LAYOUT1', master: true });
        prsn.theme = { colors: ['#07101a', '#e6f0fb', '#38bdf8', '#a78bfa', '#22c55e', '#fbbf24'] };

        const slide1 = prsn.addSlide();
        slide1.background = { color: '#07101a' };
        slide1.addText('Impact Dashboard', { x: 0.5, y: 2, w: 9, h: 1, fontSize: 54, bold: true, color: '#e6f0fb' });
        slide1.addText('FFY 2024 Overview', { x: 0.5, y: 3.1, w: 9, h: 0.5, fontSize: 24, color: '#a78bfa' });
        slide1.addText('DanBeem Ombudsman Tools and Resource Lab', { x: 0.5, y: 5, w: 9, h: 0.4, fontSize: 14, color: 'rgba(230,240,252,0.55)' });

        const slide2 = prsn.addSlide();
        slide2.background = { color: '#07101a' };
        slide2.addText('Key Performance Indicators', { x: 0.5, y: 0.5, w: 9, h: 0.5, fontSize: 36, bold: true, color: '#e6f0fb' });

        const kpis = [
          { label: 'Total Cases', value: '2,628', change: '+12.6%', x: 0.5 },
          { label: 'Resolution Rate', value: '83%', change: '3,647/4,415', x: 2.8 },
          { label: 'Resident Contacts', value: '7,980', change: '', x: 5.1 },
          { label: 'Facility Visits', value: '410', change: '', x: 7.4 }
        ];

        kpis.forEach(kpi => {
          slide2.addShape(prsn.ShapeType.rect, { x: kpi.x, y: 1.2, w: 2, h: 3.5, fill: { color: '#0a141f', transparency: 30 }, line: { color: '#38bdf8', width: 1 } });
          slide2.addText(kpi.label, { x: kpi.x + 0.1, y: 1.4, w: 1.8, h: 0.4, fontSize: 12, color: 'rgba(230,240,252,0.55)' });
          slide2.addText(kpi.value, { x: kpi.x + 0.1, y: 1.9, w: 1.8, h: 0.8, fontSize: 28, bold: true, color: '#38bdf8' });
          if (kpi.change) {
            slide2.addText(kpi.change, { x: kpi.x + 0.1, y: 2.8, w: 1.8, h: 0.5, fontSize: 11, color: '#22c55e' });
          }
        });

        const slide3 = prsn.addSlide();
        slide3.background = { color: '#07101a' };
        slide3.addText('Case Volume Comparison', { x: 0.5, y: 0.5, w: 9, h: 0.5, fontSize: 36, bold: true, color: '#e6f0fb' });

        const chartData = [
          { name: 'FFY 2023', labels: ['Cases'], values: [[2333]] },
          { name: 'FFY 2024', labels: ['Cases'], values: [[2628]] }
        ];

        slide3.addChart(prsn.ChartTypeEnum.bar, chartData, {
          x: 0.5, y: 1.2, w: 9, h: 4,
          barDir: 'bar',
          chartColors: ['#38bdf8', '#a78bfa'],
          showTitle: false,
          showLegend: true,
          legendPos: 'b'
        });

        prsn.save({ fileName: 'DanBeem_Impact_Dashboard_FFY2024.pptx' });
      } catch (err) {
        console.error('PPTX generation error:', err);
        alert('Error generating PPTX. Check console for details.');
      }
    }
  </script>
</body>
</html>
